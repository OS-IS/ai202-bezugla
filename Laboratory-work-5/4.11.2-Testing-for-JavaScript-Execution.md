# Тестування виконання JavaScript
## Огляд
Уразливість ін'єкції JavaScript - підтип міжсайтового скриптингу (XSS), який передбачає можливість ін'єкції довільного коду JavaScript, що виконується застосунком у браузері жертви. Ця вразливість може мати безліч наслідків, як-от розкриття сесійних cookie користувача, які можна використовувати для видавання себе за жертву, або, у більш загальному сенсі, вона може дати змогу зловмиснику змінити вміст сторінки, яку бачать жертви, або змінити поведінку застосунку.

Уразливості ін'єкції JavaScript можуть виникати, коли в додатку відсутня належна перевірка вхідних і вихідних даних, що надаються користувачем. Оскільки JavaScript використовується для динамічного наповнення вебсторінок, ця ін'єкція відбувається на етапі опрацювання контенту і, отже, впливає на жертву.

Під час тестування на наявність цієї вразливості враховуйте, що деякі символи обробляються різними браузерами по-різному. Для довідки див. [XSS на основі DOM](https://owasp.org/www-community/attacks/DOM_Based_XSS).

Ось приклад скрипта, який ніяк не перевіряє змінну `rr`. Змінна в рядку запиту містить користувацьке введення і, крім того, не вказує жодного кодування:

```js
var rr = location.search.substring(1);
if(rr) {
    window.location=decodeURIComponent(rr);
}
```

Це означає, що зловмисник може ввести код JavaScript, просто надіславши наступний рядок запиту `www.victim.com/?javascript:alert(1)`.
## Завдання тестування
- Знайти приймачі та можливі точки ін'єкції JavaScript.

## Як тестувати
Розглянемо таку [вправу на DOM XSS](http://www.domxss.com/domxss/01_Basics/04_eval.html)
Сторінка містить наступний скрипт:

```html
<script>
function loadObj(){
    var cc=eval('('+aMess+')');
    document.getElementById('mess').textContent=cc.message;
}

if(window.location.hash.indexOf('message')==-1) {
    var aMess='({"message":"Hello User!"})';
} else {
    var aMess=location.hash.substr(window.location.hash.indexOf('message=')+8)
}
</script>
```

Наведений вище код містить джерело `location.hash`, який контролюється зловмисником, що може вставити код JavaScript безпосередньо в значення `message`, щоб отримати контроль над браузером користувача.
